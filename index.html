<!DOCTYPE html>
<html lang="jp">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="author" content="ä¸‰ä¸Š å’Œå¾³">
<title>10åˆ†ã§ã‚ã‹ã‚‹PMlib ğŸ˜š</title>
<style>
/*	A slide template based on
	
	https://www.geeksforgeeks.org/programming-a-slideshow-with-html-and-css/
	https://stackoverflow.com/questions/13114819/positioning-elements-at-top-right-of-div
	https://singaporecss.github.io/talk.css/
	https://ondras.github.io/maslo
	https://chenhuijing.com/blog/html-slides-without-frameworks/
*/
	body {
		font-family: Helvetica, sans-serif;
		padding: 5%;
		text-align: left;
		font-size: 0.70em;
	}
	
	/* Styling the area of the slides */
	
	#content {
		overflow: hidden;
		height: 510px;
		width: 728px;
		margin: 0 auto;
	}
	
	/* Style each of the sides
	with a fixed width and height */
	
	.sect1 {
		float: left;
		height: 510px;
		width: 728px;
	}

	.paragraph {
		text-align: center;
		font-size: small;
		position: relative;
		bottom: 5;
	}

</style>
<style>
pre.rouge table td { padding: 5px; }
pre.rouge table pre { margin: 0; }
pre.rouge .cm {
  color: #999988;
  font-style: italic;
}
pre.rouge .cp {
  color: #999999;
  font-weight: bold;
}
pre.rouge .c1 {
  color: #999988;
  font-style: italic;
}
pre.rouge .cs {
  color: #999999;
  font-weight: bold;
  font-style: italic;
}
pre.rouge .c, pre.rouge .cd {
  color: #999988;
  font-style: italic;
}
pre.rouge .err {
  color: #a61717;
  background-color: #e3d2d2;
}
pre.rouge .gd {
  color: #000000;
  background-color: #ffdddd;
}
pre.rouge .ge {
  color: #000000;
  font-style: italic;
}
pre.rouge .gr {
  color: #aa0000;
}
pre.rouge .gh {
  color: #999999;
}
pre.rouge .gi {
  color: #000000;
  background-color: #ddffdd;
}
pre.rouge .go {
  color: #888888;
}
pre.rouge .gp {
  color: #555555;
}
pre.rouge .gs {
  font-weight: bold;
}
pre.rouge .gu {
  color: #aaaaaa;
}
pre.rouge .gt {
  color: #aa0000;
}
pre.rouge .kc {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kd {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kn {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kp {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kr {
  color: #000000;
  font-weight: bold;
}
pre.rouge .kt {
  color: #445588;
  font-weight: bold;
}
pre.rouge .k, pre.rouge .kv {
  color: #000000;
  font-weight: bold;
}
pre.rouge .mf {
  color: #009999;
}
pre.rouge .mh {
  color: #009999;
}
pre.rouge .il {
  color: #009999;
}
pre.rouge .mi {
  color: #009999;
}
pre.rouge .mo {
  color: #009999;
}
pre.rouge .m, pre.rouge .mb, pre.rouge .mx {
  color: #009999;
}
pre.rouge .sb {
  color: #d14;
}
pre.rouge .sc {
  color: #d14;
}
pre.rouge .sd {
  color: #d14;
}
pre.rouge .s2 {
  color: #d14;
}
pre.rouge .se {
  color: #d14;
}
pre.rouge .sh {
  color: #d14;
}
pre.rouge .si {
  color: #d14;
}
pre.rouge .sx {
  color: #d14;
}
pre.rouge .sr {
  color: #009926;
}
pre.rouge .s1 {
  color: #d14;
}
pre.rouge .ss {
  color: #990073;
}
pre.rouge .s {
  color: #d14;
}
pre.rouge .na {
  color: #008080;
}
pre.rouge .bp {
  color: #999999;
}
pre.rouge .nb {
  color: #0086B3;
}
pre.rouge .nc {
  color: #445588;
  font-weight: bold;
}
pre.rouge .no {
  color: #008080;
}
pre.rouge .nd {
  color: #3c5d5d;
  font-weight: bold;
}
pre.rouge .ni {
  color: #800080;
}
pre.rouge .ne {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nf {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nl {
  color: #990000;
  font-weight: bold;
}
pre.rouge .nn {
  color: #555555;
}
pre.rouge .nt {
  color: #000080;
}
pre.rouge .vc {
  color: #008080;
}
pre.rouge .vg {
  color: #008080;
}
pre.rouge .vi {
  color: #008080;
}
pre.rouge .nv {
  color: #008080;
}
pre.rouge .ow {
  color: #000000;
  font-weight: bold;
}
pre.rouge .o {
  color: #000000;
  font-weight: bold;
}
pre.rouge .w {
  color: #bbbbbb;
}
pre.rouge {
  background-color: #f8f8f8;
}
</style>
</head>
<body class="article">
<div id="header">
<h1>10åˆ†ã§ã‚ã‹ã‚‹PMlib ğŸ˜š</h1>
<div class="details">
<span id="author" class="author">ä¸‰ä¸Š å’Œå¾³</span><br>
<span id="revdate">2016å¹´10æœˆ26æ—¥</span>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>ç†åŒ–å­¦ç ”ç©¶æ‰€ è¨ˆç®—ç§‘å­¦ç ”ç©¶æ©Ÿæ§‹
å¯è¦–åŒ–æŠ€è¡“ç ”ç©¶ãƒãƒ¼ãƒ </p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="1">1. PMlibã¨ã¯</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨ˆç®—æ€§èƒ½ã‚’ãƒ¢ãƒ‹ã‚¿ãƒ¼ã™ã‚‹ã‚½ãƒ•ãƒˆã‚¦ã‚¨ã‚¢ãƒ©ã‚¤ãƒ–ãƒ©ãƒª</p>
</li>
<li>
<p>æ³¨ç›®ã™ã‚‹åŒºé–“ã®æ€§èƒ½çµ±è¨ˆæƒ…å ±ã‚’ç°¡å˜ã«æ¸¬å®šãƒ»ãƒ¬ãƒãƒ¼ãƒˆã™ã‚‹ã€‚</p>
</li>
<li>
<p>Cppè¨€èªã€Fortranè¨€èªã«å¯¾å¿œ ã€‚</p>
</li>
<li>
<p>Linuxç³»OSã‚’ã‚‚ã¤ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã®ä¸Šã§ä½¿ãˆã‚‹ã€‚:::</p>
<div class="ulist">
<ul>
<li>
<p>äº¬ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ»FX100</p>
</li>
<li>
<p>Intel Xeonç³»ã‚µãƒ¼ãƒãƒ»PC</p>
</li>
<li>
<p>Apple Macbook</p>
</li>
</ul>
</div>
</li>
<li>
<p>ã‚ªãƒ¼ãƒ—ãƒ³ã‚½ãƒ¼ã‚¹ã€‚</p>
<div class="ulist">
<ul>
<li>
<p>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å…¬é–‹ãƒªãƒã‚¸ãƒˆãƒª</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://avr-aics-riken.github.io/PMlib/" class="bare">http://avr-aics-riken.github.io/PMlib/</a></p>
</li>
</ul>
</div>
</li>
<li>
<p>å¿…è¦ãªå‰æã‚½ãƒ•ãƒˆã‚¦ã‚¨ã‚¢ç’°å¢ƒ</p>
<div class="ulist">
<ul>
<li>
<p>Linux OS, Cpp, C, Fortranã‚³ãƒ³ãƒ‘ã‚¤ãƒ©</p>
</li>
<li>
<p>(ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã«å¿œã˜ã¦)MPIãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€PAPIãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€OTFãƒ©ã‚¤ãƒ–ãƒ©ãƒª</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#2">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="2">2. è¨ˆç®—æ€§èƒ½ã®ãƒ¢ãƒ‹ã‚¿ãƒ¼ã¨ã¯?</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>æ³¨ç›®ã™ã‚‹åŒºé–“ã‚’æŒ‡å®šã—ã¦æ€§èƒ½çµ±è¨ˆæƒ…å ±ã‚’è“„ç©ãƒ»è¨˜éŒ²ã™ã‚‹ã“ã¨</p>
</li>
<li>
<p>æ¸¬å®šåŒºé–“ã¯å°‘æ•°ã®å±æ€§ã‚’æŒã¤</p>
<div class="ulist">
<ul>
<li>
<p>ãƒ©ãƒ™ãƒ«:ä»»æ„ã®åç§° â€ã“ã“â€ã¨ã‹â€ãã“â€ã¨ã‹</p>
</li>
<li>
<p>æ¸¬å®šã™ã‚‹è¨ˆç®—é‡ã®ç¨®é¡: ã€Œæ¼”ç®—é‡ã€ã€ã€Œé€šä¿¡é‡ã€ãªã©</p>
<div class="ulist">
<ul>
<li>
<p>æµ®å‹•å°æ•°ç‚¹æ¼”ç®—é‡ã€ãƒ‡ãƒ¼ã‚¿ç§»å‹•é‡ã€ãã®ä»–HWå›ºæœ‰ã®çµ±è¨ˆé‡ãŒã„ãã¤ã‹é¸ã¹ã‚‹</p>
</li>
</ul>
</div>
</li>
<li>
<p>æ’ä»–æ€§:ã€Œæ’ä»–çš„ã€ã‹ã€Œéæ’ä»–çš„ã€</p>
<div class="ulist">
<ul>
<li>
<p>ä»–ã®åŒºé–“ã¨ã‚«ãƒ–ã£ã¦ã„ãªã„ã‹ã¨ã„ã†æ„å‘³</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>æ¸¬å®šã™ã‚‹è¨ˆç®—é‡ã‚’ã©ã†é¸æŠãƒ»ç®—å‡ºã™ã‚‹ã‹?</p>
<div class="ulist">
<ul>
<li>
<p>PMlibãŒHWPCå€¤ã‚’è‡ªå‹•æ¸¬å®šã™ã‚‹æ–¹æ³•</p>
</li>
<li>
<p>ãƒ¦ãƒ¼ã‚¶ãŒæ˜ç¤ºçš„ã«ç”³å‘Šã™ã‚‹æ–¹æ³•</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#1">â†</a><a href="#3">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="3">3. PMlibã®åˆ©ç”¨æ–¹æ³•</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>PMlibãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹</p>
</li>
<li>
<p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ä¸­ã®æ¸¬å®šåŒºé–“ã‚’æ±ºã‚ã‚‹</p>
<div class="ulist">
<ul>
<li>
<p>ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä¸­ã®æ³¨ç›®ç®‡æ‰€ã«PMlib APIã‚’è¿½åŠ </p>
</li>
</ul>
</div>
</li>
<li>
<p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦PMlibã¨ãƒªãƒ³ã‚¯ã™ã‚‹</p>
</li>
<li>
<p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã™ã‚‹</p>
<div class="ulist">
<ul>
<li>
<p>å®Ÿè¡Œæ™‚ã«æ€§èƒ½çµ±è¨ˆæƒ…å ±ãŒãƒ¬ãƒãƒ¼ãƒˆã•ã‚Œã‚‹</p>
</li>
</ul>
</div>
</li>
<li>
<p>æ€§èƒ½çµ±è¨ˆãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèªè©•ä¾¡ã™ã‚‹</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="#2">â†</a><a href="#4">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="4">4. PMlibåŸºæœ¬APIã®ä¸€è¦§</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
<col style="width: 20%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">é–¢æ•°å(Cpp)</th>
<th class="tableblock halign-left valign-top">é–¢æ•°å(Fortran)</th>
<th class="tableblock halign-left valign-top">æ©Ÿèƒ½</th>
<th class="tableblock halign-left valign-top">å‘¼ã³å‡ºã—ä½ç½®ã¨å› æ•°</th>
<th class="tableblock halign-left valign-top">å¼•æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">initialize()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">f_pm_initialize()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PMlib å…¨ä½“ã®åˆæœŸåŒ–</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">å†’é ­â– ä¸€å›</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(1)æ¸¬å®šåŒºé–“æ•°</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setProperties()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">f_pm_setproperties()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">æ¸¬å®šåŒºé–“ã®ãƒ©ãƒ™ãƒ«åŒ–</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ä»»æ„â– å„åŒºé–“ä¸€å›</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">â‘´ãƒ©ãƒ™ãƒ«ã€ï¼ˆ2)æ¸¬å®šå¯¾è±¡ã‚¿ã‚¤ãƒ—ã€ï¼ˆ3)æ’ä»– æŒ‡å®š</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">start()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">f_pm_start()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">æ¸¬å®šã®é–‹å§‹</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ä»»æ„(startã¨stopã§ ãƒšã‚¢ï¼‰</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(1)ãƒ©ãƒ™ãƒ«</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">stop()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">f_pm_stop()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">æ¸¬å®šã®åœæ­¢</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ä»»æ„(startã¨stopã§ ãƒšã‚¢ï¼‰</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(1)ãƒ©ãƒ™ãƒ«ã€ï¼ˆ2)è¨ˆç®—é‡ã€ï¼ˆ3)è¨ˆç®—ã®ã‚¿ã‚¹ã‚¯ æ•°</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">f_pm_print()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">æ¸¬å®šåŒºé–“æ¯ã®åŸºæœ¬ çµ±è¨ˆçµæœè¡¨ç¤º</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">æ¸¬å®šçµ‚äº†æ™‚â– ä¸€å›</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(1)å‡ºã‚«ãƒ•ã‚¡ã‚¤ãƒ«ãƒã‚¤ãƒ³ã‚¿ã€ï¼ˆ2)ãƒ›ã‚¹ãƒˆåã€ (3)ä»»æ„ã®ã‚³ãƒ¡ãƒ³ãƒˆã€ï¼ˆ4)åŒºé–“ã®è¡¨ç¤ºé † åºæŒ‡å®š</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">printDetail()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">f_pm_printdetail()</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MPIãƒ©ãƒ³ã‚¯æ¯ã®è©³ç´° æ€§èƒ½æƒ…å ±ã®è¡¨ç¤º</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">æ¸¬å®šçµ‚äº†æ™‚â– ä¸€å›</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">(1)å‡ºã‚«ãƒ•ã‚¡ã‚¤ãƒ«ãƒã‚¤ãƒ³ã‚¿ã€ï¼ˆ2)è¨˜å·èª¬æ˜ ã®è¡¨ç¤ºã€ï¼ˆ3)åŒºé–“ã®è¡¨ç¤ºé †åºæŒ‡å®š</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#3">â†</a><a href="#5">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="5">5. PMlibã‚’åˆ©ç”¨ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æ§‹æˆä¾‹(Fortran)</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">å…ƒã®ã‚½ãƒ¼ã‚¹</th>
<th class="tableblock halign-left valign-top">PMlibçµ„ã¿è¾¼ã¿å¾Œã®ã‚½ãƒ¼ã‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="fortran"><span class="k">program</span><span class="w"> </span><span class="n">main</span><span class="w">
</span><span class="c1">!  æ³¨ç›®ç®‡æ‰€</span><span class="w">
</span><span class="k">call</span><span class="w"> </span><span class="n">mykernel</span><span class="p">()</span><span class="w">
</span><span class="k">end</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="fortran"><span class="k">program</span><span class="w"> </span><span class="n">main</span><span class="w">
</span><span class="c1">! åˆæœŸè¨­å®š</span><span class="w">
</span><span class="k">call</span><span class="w"> </span><span class="n">f_pm_initialize</span><span class="w"> </span><span class="p">(</span><span class="n">nWatch</span><span class="p">)</span><span class="w">
</span><span class="k">call</span><span class="w"> </span><span class="n">f_pm_setproperties</span><span class="w"> </span><span class="p">(</span><span class="s2">"Koko!"</span><span class="w"> </span><span class="n">icalc</span><span class="p">,</span><span class="w"> </span><span class="n">iexcl</span><span class="p">)</span><span class="w">
</span><span class="c1">! æ¸¬å®šåŒºé–“</span><span class="w">
</span><span class="k">call</span><span class="w"> </span><span class="n">f_pm_start</span><span class="w"> </span><span class="p">(</span><span class="s2">"Koko!"</span><span class="p">)</span><span class="w">
</span><span class="k">call</span><span class="w"> </span><span class="n">mykernel</span><span class="w"> </span><span class="p">(</span><span class="n">msize</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span><span class="w">
</span><span class="k">call</span><span class="w"> </span><span class="n">f_pm_stop</span><span class="w"> </span><span class="p">(</span><span class="s2">"Koko!"</span><span class="p">,</span><span class="w"> </span><span class="n">fops</span><span class="p">,</span><span class="w"> </span><span class="n">ncall</span><span class="p">)</span><span class="w">
</span><span class="c1">! ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ›</span><span class="w">
</span><span class="k">call</span><span class="w"> </span><span class="n">f_pm_print</span><span class="w"> </span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">isort</span><span class="p">)</span><span class="w">
</span><span class="k">call</span><span class="w"> </span><span class="n">f_pm_printdetail</span><span class="w"> </span><span class="p">(</span><span class="s2">""</span><span class="p">,</span><span class="w"> </span><span class="n">ilegend</span><span class="p">,</span><span class="w"> </span><span class="n">isort</span><span class="p">)</span><span class="w">
</span><span class="k">end</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#4">â†</a><a href="#6">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="6">6. PMlibã‚’åˆ©ç”¨ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®æ§‹æˆä¾‹(Cpp)</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">å…ƒã®ã‚½ãƒ¼ã‚¹</th>
<th class="tableblock halign-left valign-top">PMlibçµ„ã¿è¾¼ã¿å¾Œã®ã‚½ãƒ¼ã‚¹</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
<span class="cm">/* æ³¨ç›®ç®‡æ‰€ */</span>
<span class="n">mykernel</span><span class="p">();</span>
<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cm">/* PMlibãƒ˜ãƒƒãƒ€ãƒ¼ */</span>
<span class="cp">#include &lt;PerfMonitor.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">pm_lib</span><span class="p">;</span>
<span class="n">PerfMonitor</span> <span class="n">PM</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
<span class="cm">/* åˆæœŸè¨­å®š */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">initialize</span><span class="p">();</span>
<span class="n">PM</span><span class="p">.</span><span class="n">setProperties</span><span class="p">(</span><span class="s">"Koko!"</span><span class="p">,</span> <span class="n">PM</span><span class="p">.</span><span class="n">CALC</span><span class="p">);</span>
<span class="cm">/* æ¸¬å®šåŒºé–“ */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="s">"Koko!"</span><span class="p">);</span>
<span class="n">mykernel</span><span class="p">();</span>
<span class="n">PM</span><span class="p">.</span><span class="n">stop</span> <span class="p">(</span><span class="s">"Koko!"</span><span class="p">);</span>
<span class="cm">/* ãƒ¬ãƒãƒ¼ãƒˆå‡ºåŠ› */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>
<span class="n">PM</span><span class="p">.</span><span class="n">printDetail</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#5">â†</a><a href="#7">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="7">7. PMlibã®å‡ºåŠ›æƒ…å ±</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>ã€åŸºæœ¬ãƒ¬ãƒãƒ¼ãƒˆ</p>
<div class="ulist">
<ul>
<li>
<p>å„æ¸¬å®šåŒºé–“ã®ãƒ—ãƒ­ã‚»ã‚¹ã‚ãŸã‚Šå¹³å‡æ€§èƒ½çµ±è¨ˆå€¤</p>
<div class="ulist">
<ul>
<li>
<p>æ™‚é–“:å„åŒºé–“ã®å¹³å‡æ™‚é–“ã€å‘¼ã³å‡ºã—å›æ•°ã€ç´¯ç©çµŒéæ™‚é–“</p>
</li>
<li>
<p>è¨ˆç®—é‡:å‘¼ã³å‡ºã—1å›ã‚ãŸã‚Šã®é‡ã€åˆè¨ˆé‡ã€é€Ÿåº¦</p>
</li>
<li>
<p>åŒºé–“ã‚’ç™»éŒ²é †ã¾ãŸã¯çµŒéæ™‚é–“é †ã«ã‚½ãƒ¼ãƒˆå‡ºåŠ›</p>
</li>
</ul>
</div>
</li>
<li>
<p>ã‚¸ãƒ§ãƒ–å…¨ä½“ã§ã®ç·åˆæ€§èƒ½</p>
</li>
</ul>
</div>
</li>
<li>
<p>ã€è©³ç´°ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«</p>
<div class="ulist">
<ul>
<li>
<p>å„MPIãƒ—ãƒ­ã‚»ã‚¹æ¯ã®ãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‡ºåŠ›</p>
</li>
<li>
<p>(ã‚ªãƒ—ã‚·ãƒ§ãƒ³)å„MPIãƒ—ãƒ­ã‚»ã‚¹æ¯ã®HWPCã‚¤ãƒ™ãƒ³ãƒˆçµ±è¨ˆé‡</p>
<div class="ulist">
<ul>
<li>
<p>HWPCã‚¤ãƒ™ãƒ³ãƒˆã‚°ãƒ«ãƒ¼ãƒ—ã‚’ç’°å¢ƒå¤‰æ•°ã§æŒ‡å®š</p>
</li>
<li>
<p>ãƒ—ãƒ­ã‚»ã‚¹ãŒOpenMPã‚¹ãƒ¬ãƒƒãƒ‰ã‚’ç™ºç”Ÿã—ãŸå ´åˆã€å„ã‚¹ãƒ¬ãƒƒãƒ‰ã®è¨ˆ ç®—é‡ã¯å…ƒãƒ—ãƒ­ã‚»ã‚¹ã«åˆç®—ã™ã‚‹ã€‚</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>ã€(ã‚ªãƒ—ã‚·ãƒ§ãƒ³)ãƒã‚¹ãƒˆå‡¦ç†ç”¨æ€§èƒ½ãƒˆãƒ¬ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="#6">â†</a><a href="#8">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="8">8. åŸºæœ¬ãƒ¬ãƒãƒ¼ãƒˆä¾‹ (HWPCè‡ªå‹•æ¸¬å®šãƒ¢ãƒ¼ãƒ‰</h2>
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre># PMlib Basic Report -------------------------------------------------------
Timing Statistics Report from PMlib version 5.0.3
Linked PMlib supports: MPI, OpenMP, HWPC, OTF
Host name : vsp01
Date      : 2016/06/19 : 15:26:50
Mrs. Kobe
Parallel Mode:  Hybrid (4 processes x 4 threads)
The environment variable HWPC_CHOOSER=FLOPS is provided.

Total execution time            = 9.848690e-01 [sec]
Total time of measured sections = 9.816217e-01 [sec]

Exclusive sections statistics per process and total job.
Inclusive sections are marked with (*)

Section           |  call    |     accumulated time[sec]              | [hardware counter byte counts]
Label             |          |   avr     avr[%]    sdv   avr/call     |      avr       sdv   speed
------------------+----------+----------------------------------------+----------------------------
First section     :        1   1.039e-01 10.59 1.32e-03 1.039e-01        4.807e+09 1.89e+06 46.26 Gflops
Second section(*) :        1   8.412e-01 85.70 4.72e-03 8.412e-01        5.226e+09 1.79e+06 6.21 Gflops(*)
Subsection X      :        3   3.106e-01 31.64 9.48e-04 1.035e-01        1.614e+10 3.24e+06 51.97 Gflops
Subsection Y      :        3   3.127e-01 31.85 4.06e-03 1.042e-01        1.568e+10 2.73e+06 50.14 Gflops
------------------+----------+----------------------------------------+----------------------------
Sections per process           7.272e-01     -Exclusive CALC sections- 3.663e+10            50.37 Gflops
------------------+----------+----------------------------------------+----------------------------
Sections total job             7.272e-01      -Exclusive CALC sections- 1.465e+11           201.47 Gflops</pre>
</div>
</div>
<div class="paragraph">
<p><a href="#7">â†</a><a href="#9">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="9">9. åŸºæœ¬ãƒ¬ãƒãƒ¼ãƒˆä¾‹ (ãƒ¦ãƒ¼ã‚¶ç”³å‘Šãƒ¢ãƒ¼ãƒ‰)</h2>
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre># PMlib Basic Report -------------------------------------------------------

    Timing Statistics Report from PMlib version 5.0.3
    Linked PMlib supports: MPI, OpenMP, HWPC, OTF
    Host name : vsp01
    Date      : 2016/06/19 : 15:28:19
    Mrs. Kobe
    Parallel Mode:    Hybrid (4 processes x 4 threads)
    The environment variable HWPC_CHOOSER is not provided. No HWPC report.

    Total execution time            = 9.795189e-01 [sec]
    Total time of measured sections = 9.816882e-01 [sec]

    Exclusive sections statistics per process and total job.
    Inclusive sections are marked with (*)

    Section           |   call   |      accumulated time[sec]             | [user defined counter values ]
    Label             |          |    avr   avr[%]   sdv     avr/call     |       avr     sdv   speed
    ------------------+----------+----------------------------------------+----------------------------
    First section     :        1   1.043e-01 10.62 1.47e-03 1.043e-01        4.000e+09 0.00e+00 38.35 Gflops
    Second section(*) :        1   8.420e-01 85.77 6.86e-03 8.420e-01        1.960e+10 0.00e+00 23.28 Gflops(*)
    Subsection X      :        3   3.120e-01 31.78 3.28e-03 1.040e-01        4.800e+10 0.00e+00 153.84 GB/sec
    Subsection Y      :        3   3.118e-01 31.76 2.72e-03 1.039e-01        1.440e+10 0.00e+00 46.18 Gflops
    ------------------+----------+----------------------------------------+----------------------------
    Sections per process           4.161e-01     -Exclusive CALC sections- 1.840e+10            44.22 Gflops
    Sections per process           3.120e-01     -Exclusive COMM sections- 4.800e+10           153.84 GB/sec
    ------------------+----------+----------------------------------------+----------------------------
    Sections total job             4.161e-01     -Exclusive CALC sections- 7.360e+10           176.87 Gflops
    Sections total job             3.120e-01     -Exclusive COMM sections- 1.920e+11           615.36 GB/sec</pre>
</div>
</div>
<div class="paragraph">
<p><a href="#8">â†</a><a href="#10">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="10">10. ?</h2>
<div class="sectionbody">
<div class="paragraph text-center">
<p>ä»¥é™ã®ã‚¹ãƒ©ã‚¤ãƒ‰ã¯ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã‚·ã‚¹ãƒ†ãƒ æ¯ã«</p>
</div>
<div class="paragraph text-center">
<p>åˆ¥ã‚ŒãŸå†…å®¹ã«ãªã£ã¦ã„ã¾ã™ã€‚</p>
</div>
<div class="paragraph text-center">
<p>Intelç’°å¢ƒç·¨</p>
</div>
<div class="paragraph text-center">
<p>äº¬ãƒ»FX100ç·¨</p>
</div>
<div class="paragraph text-center">
<p>Macãƒ»OSXç·¨</p>
</div>
<div class="paragraph text-center">
<p>é©åˆ‡ãªã‚‚ã®ã‚’é¸ã‚“ã§ãŠèª­ã¿ãã ã•ã„</p>
</div>
<div class="paragraph">
<p><a href="#9">â†</a><a href="#11">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="11">11. Intel</h2>
<div class="sectionbody">
<div class="paragraph text-center">
<p>10åˆ†+ã§ã§ãã‚‹PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨åˆ©ç”¨ğŸ˜š</p>
</div>
<div class="paragraph text-center">
<p>Intelç’°å¢ƒç·¨</p>
</div>
<div class="paragraph text-center">
<p>(Intel ã‚µãƒ¼ãƒ w/ Intelã‚³ãƒ³ãƒ‘ã‚¤ãƒ©+Intel MPI)</p>
</div>
<div class="paragraph">
<p><a href="#10">â†</a><a href="#12">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="12">12. PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨åˆ©ç”¨å®Ÿè¡Œ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</p>
<div class="ulist">
<ul>
<li>
<p>PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å…¥æ‰‹</p>
</li>
<li>
<p>PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</p>
</li>
</ul>
</div>
</li>
<li>
<p>PMlibã®åˆ©ç”¨å®Ÿè¡Œ</p>
<div class="ulist">
<ul>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ(Cppè¨€èªã§ä½œæˆ)</p>
</li>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¸ã®PMlibã®è¿½åŠ (ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç·¨é›†)</p>
</li>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦PMlibã‚’ãƒªãƒ³ã‚¯ã™ã‚‹</p>
</li>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã—ã¦ã€PMlibã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèªã™ã‚‹</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>(æ³¨)ã“ã“ã§ã¯PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®åˆ©ç”¨å®Ÿè¡ŒãŒåŒã˜ç¨®é¡ã®Intel Xeon CPUä¸Šã§è¡Œã‚ã‚Œã‚‹ã“ã¨ã‚’æƒ³å®šã—ã¦ã„ã‚‹ã€‚</code></p>
</li>
<li>
<p><code>(æ³¨)ã“ã“ã§ã¯Intelã‚³ãƒ³ãƒ‘ã‚¤ãƒ©+Intel MPIã®ã‚½ãƒ•ãƒˆã‚¦ã‚¨ã‚¢ç’°å¢ƒã‚’æƒ³å®šã—ã¦ã„ã‚‹ã€‚GNUã‚³ãƒ³ãƒ‘ã‚¤ãƒ© ã‚’ç”¨ã„ãŸå ´åˆã€ã‚ã‚‹ã„ã¯OpenMPIã‚’ç”¨ã„ãŸå ´åˆãªã©ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ä¾‹ã«ã¤ã„ã¦ã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã«å«ã¾ã‚Œã‚‹INSTALLãƒ•ã‚¡ã‚¤ãƒ«ã‚’å‚ç…§</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#11">â†</a><a href="#13">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="13">13. PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å…¥æ‰‹(å…±é€š)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å…¬é–‹ãƒªãƒã‚¸ãƒˆãƒª</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://avr-aics-riken.github.io/PMlib/" class="bare">http://avr-aics-riken.github.io/PMlib/</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="download.png" alt="ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã®GitHubãƒšãƒ¼ã‚¸ã‚’ç¤ºã™ç”»åƒ">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«åã¯ avr-aics-riken-PMlib-*.tar.gz</p>
<div class="ulist">
<ul>
<li>
<p>(*ã®éƒ¨åˆ†ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã‚Šå¤‰ã‚ã‚‹)</p>
</li>
</ul>
</div>
</li>
<li>
<p>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«è»¢é€ã™ã‚‹ã€‚æ‰‹æŒã¡ã®PCã¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å ´åˆã¯ã€ã‚‚ã¡ã‚ã‚“è»¢é€ä¸è¦ã€‚</p>
<div class="ulist">
<ul>
<li>
<p>ä»¥é™ã®ä¾‹ã§ã¯ ${HOME}/tmp/ ä¸‹ã«è»¢é€ã—ãŸã¨ä»®å®š</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#12">â†</a><a href="#14">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="14">14. PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å±•é–‹(å…±é€š)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ä¸Šã§ã€è»¢é€ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å±•é–‹ã™ã‚‹</p>
</li>
<li>
<p>å±•é–‹ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã¨ã€ãƒ‘ã‚¹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹ã€‚</p>
</li>
<li>
<p>ä»¥ä¸‹ã®ä¾‹ã§ã¯ãƒ­ã‚°ã‚¤ãƒ³å¾Œãƒ›ãƒ¼ãƒ ã« pmlib ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œã£ã¦ã€ãã®ä¸‹ã«è»¢é€ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å±•é–‹ã™ã‚‹ã€‚</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span>mkdir pmlib
<span class="gp">$ </span><span class="nb">cd </span>pmlib
<span class="gp">$ </span>tar â€“zxf <span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/tmp/avr-aics-riken-PMlib-<span class="k">*</span>.tar.gz
<span class="gp">$ </span>ls â€“go
drwxr-xr-x 10 4096 2016-06-21 15:13 avr-aics-riken-PMlib-7d4884d

<span class="gp">$ </span>ln â€“s avr-aics-riken-PMlib-<span class="k">*</span> PMlib
<span class="gp">$ </span>ls â€“go
lrwxrwxrwx 1 12 2016-06-21 15:15 PMlib -&gt; avr-aics-riken-PMlib-7d4884d

<span class="gp">$ </span><span class="nv">PMLIB_DIR</span><span class="o">=</span><span class="k">${</span><span class="nv">PWD</span><span class="k">}</span>/PMlib           <span class="c"># PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å±•é–‹ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª</span>
<span class="gp">$ </span><span class="nv">INSTALL_DIR</span><span class="o">=</span><span class="k">${</span><span class="nv">PWD</span><span class="k">}</span>/install_dir   <span class="c"># PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª</span>
<span class="gp">$ </span><span class="nb">export </span>PMLIB_DIR INSTALL_DIR</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#13">â†</a><a href="#15">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="15">15. PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« Intelç’°å¢ƒ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Intelç’°å¢ƒç”¨ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹ã¯ä»¥ä¸‹ã«æä¾›ã•ã‚Œã¦ã„ã‚‹</p>
<div class="ulist">
<ul>
<li>
<p><code>$ SCRIPTS=${PMLIB_DIR}/doc/scripts/Intel/</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¨®é¡ã«ã‚ˆã‚Šã€PMlibã€Œ1ãƒ—ãƒ­ã‚»ã‚¹ç‰ˆã€ã‹ã€ŒMPIç‰ˆã€ã‹ã®ã©ã¡ã‚‰ã‹ã‚’ä½¿ç”¨ã™ã‚‹ã®ã§ã€ä¸¡æ–¹ã¨ã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚</p>
</li>
<li>
<p>Intelã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã€Intel MPIã€PAPIãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã‚·ã‚¹ãƒ†ãƒ ã«ã‚ˆã£ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ãƒ‘ã‚¹ãŒç•°ãªã‚‹ã€‚PMlibã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ç”¨ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§è¨­å®šã•ã‚Œã¦ã„ã‚‹ãƒ‘ã‚¹ãŒæ­£ã—ã„ã‹ç¢ºèªã—ã¦ã€å¿…è¦ã§ã‚ã‚Œã°ä¿®æ­£ã™ã‚‹ã€‚</p>
</li>
<li>
<p>ã€Œ1ãƒ—ãƒ­ã‚»ã‚¹ç‰ˆã€ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ${SCRIPTS}/x.make-pmlib-intel-serial.sh</p>
<div class="ulist">
<ul>
<li>
<p><code>Nè¡Œç›®INTEL_DIR=/usr/local/intel/composer_xe_2013</code></p>
</li>
<li>
<p><code>Nè¡Œç›®PAPI_DIR=/usr/local/papi/papi-5.3.2/intel</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>ã€ŒIntel MPIç‰ˆã€ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ${SCRIPTS}/x.make-pmlib-intel-impi.sh</p>
<div class="ulist">
<ul>
<li>
<p><code>Nè¡Œç›® INTEL_DIR=/usr/local/intel/composer_xe_2013</code></p>
</li>
<li>
<p><code>Nè¡Œç›® MPI_DIR=/usr/local/intel/impi/4.1.0.024</code></p>
</li>
<li>
<p><code>Nè¡Œç›® PAPI_DIR=/usr/local/papi/papi-5.3.2/intel</code></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#14">â†</a><a href="#16">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="16">16. PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« Intelç’°å¢ƒ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’2ã¤é †ã«å®Ÿè¡Œ</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ${SCRIPTS}/x.make-intel-serial.sh  # ã€Œ1ãƒ—ãƒ­ã‚»ã‚¹ç‰ˆã€PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
$ ${SCRIPTS}/x.make-intel-impi.sh    # ã€ŒIntel MPIç‰ˆã€PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸäº‹ã‚’ç¢ºèªã™ã‚‹</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ls â€“go ${INSTALL_DIR}
drwxr-xr-x 3 102 6 19 17:51 bin
drwxr-xr-x 6 204 6 19 17:51 doc
drwxr-xr-x 7 238 6 19 17:51 include
drwxr-xr-x 4 136 6 19 17:51 lib
drwxr-xr-x 7 238 6 19 17:51 share

$ ls â€“go ${INSTALL_DIR}/lib
-rw-r--r-- 1 145784 5 27 17:15 libPM.a         # ã€Œ1ãƒ—ãƒ­ã‚»ã‚¹ç‰ˆã€PMlibãƒ©ã‚¤ãƒ–ãƒ©ãƒª
-rw-r--r-- 1 472104 6 19 17:51 libPMmpi.a      # ã€ŒIntel MPIç‰ˆã€PMlibãƒ©ã‚¤ãƒ–ãƒ©ãƒª</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>ä»¥ä¸Šã§PMlibã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«çµ‚äº†!</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#15">â†</a><a href="#17">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="17">17. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ(Cppç‰ˆ)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>é©å½“ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ${MY_SRC} ã®ä¸‹ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ  mxm.cpp ã‚’ä½œæˆã™ã‚‹</p>
</li>
<li>
<p>Næ¬¡ã®æ­£æ–¹è¡Œåˆ—ã®ç©ã‚’è¨ˆç®—ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ </p>
<div class="ulist">
<ul>
<li>
<p>ä¸»ãƒ—ãƒ­ã‚°ãƒ©ãƒ :é–¢æ•°1ã¨é–¢æ•°2ã‚’å‘¼ã³å‡ºã—ã¦è¡Œåˆ—ç©ã®è¨ˆç®—ã‚’è¡Œã†ã€‚</p>
</li>
<li>
<p>é–¢æ•°1:æ­£æ–¹è¡Œåˆ—[A]ã€[B]ã®å„è¦ç´ ã‚’å€¤1.0ã§åˆæœŸåŒ–ã™ã‚‹</p>
</li>
<li>
<p>é–¢æ•°2:è¡Œåˆ—ç©[C]=[A][B]ã‚’è¨ˆç®—ã™ã‚‹</p>
</li>
<li>
<p>ã‚·ãƒªã‚¢ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ (MPIä¸è¦ã€OpenMPä¸è¦)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash">---
<span class="gp">$ </span><span class="nv">MY_SRC</span><span class="o">=</span><span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/pmlib/mysrc
<span class="gp">$ </span>mkdir -p <span class="k">${</span><span class="nv">MY_SRC</span><span class="k">}</span>
<span class="gp">$ </span><span class="nb">cd</span> <span class="k">${</span><span class="nv">MY_SRC</span><span class="k">}</span>
---</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>è‡ªåˆ†ã§ã‚½ãƒ¼ã‚¹ã‚’æ›¸ã„ã¦ã‚‚ã‚‚ã¡ã‚ã‚“è‰¯ã„ vi mxm.cpp</p>
</li>
<li>
<p>æ‰‹æ—©ãé€²ã¿ãŸã„å ´åˆã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä¾‹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã‚‚è‰¯ã„</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>$ vi mxm.cpp</code>
ã‚ã‚‹ã„ã¯
<code>$ cp â€“p ${PMLIB_DIR}/doc/src_tutorial/mxm.cpp ./</code></p>
</div>
<div class="paragraph">
<p><a href="#16">â†</a><a href="#18">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="18">18. è¡Œåˆ—ç©ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä¾‹ Cpp</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include "matrix.h"
</span><span class="kt">void</span> <span class="n">init2d</span><span class="p">();</span>
<span class="kt">void</span> <span class="n">mxm2d</span><span class="p">();</span>
<span class="cm">/* ä¸»ãƒ—ãƒ­ã‚°ãƒ©ãƒ éƒ¨åˆ† */</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="n">init2d</span><span class="p">();</span>
<span class="n">mxm2d</span><span class="p">();</span>
<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
<span class="kt">void</span> <span class="nf">init2d</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">nsize</span><span class="p">;</span>
  <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span> <span class="o">=</span> <span class="n">MATSIZE</span><span class="p">;</span>
  <span class="n">nsize</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">nsize</span><span class="p">;</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">b2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">c2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="kt">void</span> <span class="nf">mxm2d</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">nsize</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">c1</span><span class="p">;</span>
  <span class="n">nsize</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
      <span class="n">c1</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">){</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span>
          <span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">matrix</span><span class="p">.</span><span class="n">b2d</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">c2d</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c1</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ« matrix.h ã®å†…å®¹</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cp">#define MATSIZE 1000
</span><span class="k">struct</span> <span class="n">matrix</span> <span class="p">{</span>
  <span class="kt">double</span> <span class="n">a2d</span><span class="p">[</span><span class="n">MATSIZE</span><span class="p">][</span><span class="n">MATSIZE</span><span class="p">];</span>
  <span class="kt">double</span> <span class="n">b2d</span><span class="p">[</span><span class="n">MATSIZE</span><span class="p">][</span><span class="n">MATSIZE</span><span class="p">];</span>
  <span class="kt">double</span> <span class="n">c2d</span><span class="p">[</span><span class="n">MATSIZE</span><span class="p">][</span><span class="n">MATSIZE</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">nsize</span><span class="p">;</span>
<span class="p">}</span> <span class="n">matrix</span><span class="p">;</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#17">â†</a><a href="#19">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="19">19. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¸ã®PMlibã®è¿½åŠ </h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">*  å…ƒã®ä¸»ãƒ—ãƒ­ã‚°ãƒ©ãƒ éƒ¨åˆ†</th>
<th class="tableblock halign-left valign-top">* PMlibã‚’è¿½åŠ ã—ãŸä¸»ãƒ—ãƒ­ã‚°ãƒ©ãƒ éƒ¨åˆ†</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cm">/* ãƒ˜ãƒƒãƒ€ãƒ¼ */</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>

<span class="cm">/* åˆæœŸè¨­å®š */</span>


<span class="cm">/* æ¸¬å®šåŒºé–“1 */</span>
<span class="n">init2d</span><span class="p">();</span>


<span class="cm">/* æ¸¬å®šåŒºé–“2 */</span>
<span class="n">mxm2d</span><span class="p">();</span>

<span class="cm">/* ãƒ¬ãƒãƒ¼ãƒˆã‚’å‡ºåŠ› */</span>
<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cm">/* ãƒ˜ãƒƒãƒ€ãƒ¼è¿½åŠ  */</span>
<span class="cp">#include &lt;PerfMonitor.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">pm_lib</span><span class="p">;</span>
<span class="n">PerfMonitor</span> <span class="n">PM</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="n">PM</span><span class="p">.</span><span class="n">initialize</span><span class="p">();</span>
<span class="cm">/* åˆæœŸè¨­å®š */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">setProperties</span><span class="p">(</span><span class="s">"A:init2d"</span><span class="p">,</span><span class="n">PM</span><span class="p">.</span><span class="n">CALC</span><span class="p">);</span>
<span class="n">PM</span><span class="p">.</span><span class="n">setProperties</span><span class="p">(</span><span class="s">"B:mxm2d"</span><span class="p">,</span><span class="n">PM</span><span class="p">.</span><span class="n">CALC</span><span class="p">);</span>
<span class="cm">/* æ¸¬å®šåŒºé–“1 */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="s">"A:init2d"</span><span class="p">);</span>
<span class="n">init2d</span><span class="p">();</span>
<span class="n">PM</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="s">"A:init2d"</span><span class="p">);</span>
<span class="cm">/* æ¸¬å®šåŒºé–“2 */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="s">"B:mxm2d"</span><span class="p">);</span>
<span class="n">mxm2d</span><span class="p">();</span>
<span class="n">PM</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="s">"B:mxm2d"</span><span class="p">);</span>
<span class="cm">/* ãƒ¬ãƒãƒ¼ãƒˆã‚’å‡ºåŠ› */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span><span class="s">""</span><span class="p">);</span>
<span class="n">PM</span><span class="p">.</span><span class="n">printDetail</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#18">â†</a><a href="#20">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="20">20. ã‚³ãƒ³ãƒ‘ã‚¤ãƒ« Intelç’°å¢ƒ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦PMlibã‚’ãƒªãƒ³ã‚¯ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹</p>
<div class="ulist">
<ul>
<li>
<p>x.compile-cpp-intel-serial.sh</p>
</li>
<li>
<p>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å†…å®¹ã‚’ç¢ºèªã™ã‚‹</p>
</li>
<li>
<p>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒçµ‚äº†ã™ã‚‹ã¨å®Ÿè¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ  a.out ãŒç”Ÿæˆã•ã‚Œã‚‹</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span><span class="k">${</span><span class="nv">SCRIPTS</span><span class="k">}</span>/x.compile-cpp-intel-serial.sh
<span class="gp">$ </span>file ./a.out
./a.out: ELF 64-bit LSB executable, x86-64, version 1 <span class="o">(</span>GNU/Linux<span class="o">)</span>, dynamically linked <span class="o">(</span>uses shared libs<span class="o">)</span>, <span class="k">for </span>GNU/Linux 2.6.18, not stripped</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#19">â†</a><a href="#21">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="21">21. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œ Intelç’°å¢ƒ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œæ–¹æ³•(ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚‹ã‚¸ãƒ§ãƒ–æŠ•å…¥)</p>
<div class="ulist">
<ul>
<li>
<p>(æ³¨)Intelã‚µãƒ¼ãƒã§ã¯ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ãƒãƒƒãƒã‚¸ãƒ§ãƒ–ã§å®Ÿè¡Œã™ã‚‹äº‹ãŒå¤šãã€ãƒãƒƒãƒã‚¸ãƒ§ãƒ–ç®¡ç†ã‚½ãƒ•ãƒˆã®ç¨®é¡ãƒ»æ§‹æˆã«ã¯æ§˜ã€…ãªãƒ‘ã‚¿ãƒ¼ãƒ³ãŒã‚ã‚‹ã€‚ä»¥ä¸‹ã¯LSFã®å ´åˆã®ä¾‹ã§ã‚ã‚‹ãŒã€åˆ©ç”¨ã™ã‚‹ã‚·ã‚¹ãƒ†ãƒ ã«åˆã‚ã›ã¦å®Ÿè¡Œã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®æŒ‡ç¤ºè¡Œéƒ¨åˆ†ã‚’é©å®œä¿®æ­£ã™ã‚‹ã€‚</p>
</li>
<li>
<p>ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¸­ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãƒ‘ã‚¹(MY_SRC)è¨­å®šãŒæ­£ã—ã„ã“ã¨ã‚’ç¢ºèªã€‚</p>
</li>
<li>
<p>æœ€åˆã¯ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’ãã®ã¾ã¾å®Ÿè¡Œã™ã‚‹ã€‚(ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”³å‘Šãƒ¢ãƒ¼ãƒ‰)</p>
</li>
<li>
<p>æ¬¡ã«ç’°å¢ƒå¤‰æ•°ã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œã™ã‚‹ã€‚(HWPCã«ã‚ˆã‚‹è‡ªå‹•æ¸¬å®šãƒ¢ãƒ¼ãƒ‰)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span>cp <span class="k">${</span><span class="nv">SCRIPTS</span><span class="k">}</span>/x.run-intel-serial.sh ./
<span class="gp">$ </span>vi ./x.run-intel-serial.sh
<span class="gp">$ </span>bsub &lt; ./x.run-intel-serial.sh</code></pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p>é€šå¸¸å®Ÿè¡Œ(ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”³å‘Šãƒ¢ãƒ¼ãƒ‰)
<code>./a.out</code></p>
</li>
<li>
<p>HWPCã«ã‚ˆã‚‹è‡ªå‹•æ¸¬å®šãƒ¢ãƒ¼ãƒ‰
<code>export HWPC_CHOOSER=FLOPS</code>
<code>./a.out</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="ulist">
<ul>
<li>
<p>å®Ÿè¡Œçµæœæ¨™æº–å‡ºåŠ›ã§PMlibã®åŸºæœ¬ãƒ¬ãƒãƒ¼ãƒˆãƒ»è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèª</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#20">â†</a><a href="#22">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="22">22. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¸ã®OpenMPæŒ‡ç¤ºè¡Œã®è¿½åŠ </h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«OpenMPæŒ‡ç¤ºè¡Œã‚’è¿½åŠ </p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="kt">void</span> <span class="nf">init2d</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">nsize</span><span class="p">;</span>
  <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span> <span class="o">=</span> <span class="n">MATSIZE</span><span class="p">;</span>
  <span class="n">nsize</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span><span class="p">;</span>
  <span class="cp">#pragma omp parallel for private(i,j)
</span>  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">ipp</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">jpp</span><span class="p">){</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">nsize</span><span class="p">;</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">b2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">c2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="kt">void</span> <span class="nf">mxm2d</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">nsize</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">c1</span><span class="p">;</span>
  <span class="n">nsize</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span><span class="p">;</span>
  <span class="cp">#pragma omp parallel for private(i,j,k,c1)
</span>  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">ipp</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">jpp</span><span class="p">){</span>
      <span class="n">c1</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">kpp</span><span class="p">){</span>
      <span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">matrix</span><span class="p">.</span><span class="n">b2d</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
    <span class="p">}</span>
    <span class="p">...</span><span class="err">ä»¥ä¸‹ç•¥</span><span class="p">...</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#21">â†</a><a href="#23">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="23">23. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¨å®Ÿè¡Œ Intelç’°å¢ƒ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ãƒ­ã‚°ã‚¤ãƒ³ãƒãƒ¼ãƒ‰ä¸Šã§å†åº¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>${SCRIPTS}/x.compile-cpp-intel-serial.sh</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>ç’°å¢ƒå¤‰æ•°ã‚’è¿½åŠ ãƒ»å¤‰æ›´ã—ã¦å†å®Ÿè¡Œ</p>
<div class="ulist">
<ul>
<li>
<p>ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§æ¸¬å®šæ¡ä»¶ã‚’å¤‰æ›´ã—ã¦å‡ºåŠ›çµæœã‚’æ¯”è¼ƒã™ã‚‹</p>
</li>
<li>
<p>OMP_NUM_THREADS=1/2/4/8ãªã©:OpenMPã‚¹ãƒ¬ãƒƒãƒ‰æ•°</p>
</li>
<li>
<p>HWPC_CHOOSER=FLOPS/BANDWIDTH/ãªã©:HWPCæ¸¬å®šã®ã‚¿ã‚¤ãƒ—</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>$ vi x.run-intel-serial.sh</code>
<code>$ bsub &lt; ./x.run-intel-serial.sh</code></p>
</div>
<div class="paragraph">
<p><a href="#22">â†</a><a href="#24">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="24">24. FX100</h2>
<div class="sectionbody">
<div class="paragraph text-center">
<p>10åˆ†+ã§ã§ãã‚‹PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨åˆ©ç”¨ğŸ˜š</p>
</div>
<div class="paragraph text-center">
<p>FX100ãƒ»äº¬ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ç·¨</p>
</div>
<div class="paragraph">
<p><a href="#23">â†</a><a href="#25">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="25">25. PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨åˆ©ç”¨å®Ÿè¡Œ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</p>
<div class="ulist">
<ul>
<li>
<p>PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å…¥æ‰‹</p>
</li>
<li>
<p>PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</p>
</li>
</ul>
</div>
</li>
<li>
<p>PMlibã®åˆ©ç”¨å®Ÿè¡Œ</p>
<div class="ulist">
<ul>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ(C++è¨€èªã§ä½œæˆ)</p>
</li>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¸ã®PMlibã®è¿½åŠ (ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç·¨é›†)</p>
</li>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦PMlibã‚’ãƒªãƒ³ã‚¯ã™ã‚‹</p>
</li>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã—ã¦ã€PMlibã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèªã™ã‚‹</p>
</li>
</ul>
</div>
</li>
<li>
<p>(æ³¨)ã“ã®èª¬æ˜è³‡æ–™ã§ã¯PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ãƒ»ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¯ãƒ­ã‚°ã‚¤ãƒ³ãƒãƒ¼ãƒ‰ä¸Šã§è¡Œã„ã€ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œã¯è¨ˆç®—ãƒãƒ¼ãƒ‰ä¸Šã§è¡Œã‚ã‚Œã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦ã„ã‚‹ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#24">â†</a><a href="#26">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="26">26. PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å…¥æ‰‹(å…±é€š)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å…¬é–‹ãƒªãƒã‚¸ãƒˆãƒª</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://avr-aics-riken.github.io/PMlib/" class="bare">http://avr-aics-riken.github.io/PMlib/</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="download.png" alt="ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã®GitHubãƒšãƒ¼ã‚¸ã‚’ç¤ºã™ç”»åƒ">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«åã¯ avr-aics-riken-PMlib-*.tar.gz</p>
<div class="ulist">
<ul>
<li>
<p>(\*ã®éƒ¨åˆ†ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã‚Šå¤‰ã‚ã‚‹)</p>
</li>
</ul>
</div>
</li>
<li>
<p>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«è»¢é€ã™ã‚‹ã€‚æ‰‹æŒã¡ã®PCã¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å ´åˆã¯ã€ã‚‚ã¡ã‚ã‚“è»¢é€ä¸è¦ã€‚</p>
<div class="ulist">
<ul>
<li>
<p>ä»¥é™ã®ä¾‹ã§ã¯ ${HOME}/tmp/ ä¸‹ã«è»¢é€ã—ãŸã¨ä»®å®š</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#25">â†</a><a href="#27">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="27">27. PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å±•é–‹(å…±é€š)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ä¸Šã§ã€è»¢é€ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å±•é–‹ã™ã‚‹</p>
</li>
<li>
<p>å±•é–‹ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã¨ã€ãƒ‘ã‚¹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹ã€‚</p>
</li>
<li>
<p>ä»¥ä¸‹ã®ä¾‹ã§ã¯ãƒ­ã‚°ã‚¤ãƒ³å¾Œãƒ›ãƒ¼ãƒ ã« pmlib ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œã£ã¦ã€ãã®ä¸‹ã«è»¢é€ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å±•é–‹ã™ã‚‹ã€‚</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span>mkdir pmlib
<span class="gp">$ </span><span class="nb">cd </span>pmlib
<span class="gp">$ </span>tar â€“zxf <span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/tmp/avr-aics-riken-PMlib-<span class="k">*</span>.tar.gz
<span class="gp">$ </span>ls â€“go
drwxr-xr-x 10 4096 2016-06-21 15:13 avr-aics-riken-PMlib-7d4884d
<span class="gp">$ </span>ln â€“s avr-aics-riken-PMlib-<span class="k">*</span> PMlib
<span class="gp">$ </span>ls â€“go
lrwxrwxrwx 1 12 2016-06-21 15:15 PMlib -&gt; avr-aics-riken-PMlib-7d4884d
<span class="gp">$ </span><span class="nv">PMLIB_DIR</span><span class="o">=</span><span class="k">${</span><span class="nv">PWD</span><span class="k">}</span>/PMlib          <span class="c"># PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å±•é–‹ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª</span>
<span class="gp">$ </span><span class="nv">INSTALL_DIR</span><span class="o">=</span><span class="k">${</span><span class="nv">PWD</span><span class="k">}</span>/install_dir  <span class="c"># PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª</span>
<span class="gp">$ </span><span class="nb">export </span>PMLIB_DIR INSTALL_DIR</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#26">â†</a><a href="#28">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="28">28. PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« FX100ãƒ»äº¬ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>FX100ãƒ»äº¬ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ç”¨ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã¯å…±é€šã§ã€ä»¥ä¸‹ã«ä¾‹ãŒæä¾›ã•ã‚Œã¦ã„ã‚‹</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>$ SCRIPTS=${PMLIB_DIR}/doc/scripts/K/</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¨®é¡ã«ã‚ˆã‚Šã€PMlibã€Œ1ãƒ—ãƒ­ã‚»ã‚¹ç‰ˆã€ã‹ã€ŒMPIç‰ˆã€ã‹ã®ã©ã¡ã‚‰ã‹ã‚’ä½¿ç”¨ã™ã‚‹ã®ã§ã€ä¸¡æ–¹ã¨ã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚</p>
</li>
<li>
<p>ã€Œ1ãƒ—ãƒ­ã‚»ã‚¹ç‰ˆã€PMlibã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</p>
<div class="ulist">
<ul>
<li>
<p>${SCRIPTS}/x.make-pmlib-K-serial.sh</p>
</li>
</ul>
</div>
</li>
<li>
<p>ã€ŒMPIç‰ˆã€PMlibã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆ</p>
<div class="ulist">
<ul>
<li>
<p>${SCRIPTS}/x.make-pmlib-K-impi.sh</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#27">â†</a><a href="#29">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="29">29. PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« FX100ãƒ»äº¬ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ãƒ­ã‚°ã‚¤ãƒ³ãƒãƒ¼ãƒ‰ä¸Šã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’2ã¤é †ã«å®Ÿè¡Œ</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span><span class="k">${</span><span class="nv">SCRIPTS</span><span class="k">}</span>/x.make-pmlib-K-serial.sh   <span class="c"># ã€Œ1ãƒ—ãƒ­ã‚»ã‚¹ç‰ˆã€ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</span>
<span class="gp">$ </span><span class="k">${</span><span class="nv">SCRIPTS</span><span class="k">}</span>/x.make-pmlib-K-mpi.sh      <span class="c"># ã€ŒMPIç‰ˆã€ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸäº‹ã‚’ç¢ºèªã™ã‚‹</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span>ls â€“go <span class="k">${</span><span class="nv">INSTALL_DIR</span><span class="k">}</span>
drwxr-xr-x 3 102 6 19 17:51 bin
drwxr-xr-x 6 204 6 19 17:51 doc
drwxr-xr-x 7 238 6 19 17:51 include
drwxr-xr-x 4 136 6 19 17:51 lib
drwxr-xr-x 7 238 6 19 17:51 share
<span class="gp">$ </span>ls â€“go <span class="k">${</span><span class="nv">INSTALL_DIR</span><span class="k">}</span>/lib
-rw-r--r-- 1 145784 5 27 17:15 libPM.a         <span class="c">#ã€Œ1ãƒ—ãƒ­ã‚»ã‚¹ç‰ˆã€PMlibãƒ©ã‚¤ãƒ–ãƒ©ãƒª</span>
-rw-r--r-- 1 472104 6 19 17:51 libPMmpi.a      <span class="c">#ã€ŒMPIç‰ˆã€PMlibãƒ©ã‚¤ãƒ–ãƒ©ãƒª</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>ä»¥ä¸Šã§PMlibã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«çµ‚äº†!</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#28">â†</a><a href="#30">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="30">30. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ(Cppç‰ˆ)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>é©å½“ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ${MY_SRC} ã®ä¸‹ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ  mxm.cpp ã‚’ä½œæˆã™ã‚‹</p>
</li>
<li>
<p>Næ¬¡ã®æ­£æ–¹è¡Œåˆ—ã®ç©ã‚’è¨ˆç®—ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ </p>
<div class="ulist">
<ul>
<li>
<p>ä¸»ãƒ—ãƒ­ã‚°ãƒ©ãƒ :é–¢æ•°1ã¨é–¢æ•°2ã‚’å‘¼ã³å‡ºã—ã¦è¡Œåˆ—ç©ã®è¨ˆç®—ã‚’è¡Œã†ã€‚</p>
</li>
<li>
<p>é–¢æ•°1:æ­£æ–¹è¡Œåˆ—[A]ã€[B]ã®å„è¦ç´ ã‚’å€¤1.0ã§åˆæœŸåŒ–ã™ã‚‹</p>
</li>
<li>
<p>é–¢æ•°2:è¡Œåˆ—ç©[C]=[A][B]ã‚’è¨ˆç®—ã™ã‚‹</p>
</li>
<li>
<p>ã‚·ãƒªã‚¢ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ (MPIä¸è¦ã€OpenMPä¸è¦)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span><span class="nv">MY_SRC</span><span class="o">=</span><span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/pmlib/mysrc
<span class="gp">$ </span>mkdir -p <span class="k">${</span><span class="nv">MY_SRC</span><span class="k">}</span>
<span class="gp">$ </span><span class="nb">cd</span> <span class="k">${</span><span class="nv">MY_SRC</span><span class="k">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>è‡ªåˆ†ã§ã‚½ãƒ¼ã‚¹ã‚’æ›¸ã„ã¦ã‚‚ã‚‚ã¡ã‚ã‚“è‰¯ã„ vi mxm.cpp</p>
</li>
<li>
<p>æ‰‹æ—©ãé€²ã¿ãŸã„å ´åˆã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä¾‹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã‚‚è‰¯ã„</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>$ vi mxm.cpp</code>
ã‚ã‚‹ã„ã¯
<code>$ cp â€“p ${PMLIB_DIR}/doc/src_tutorial/mxm.cpp ./</code></p>
</div>
<div class="paragraph">
<p><a href="#29">â†</a><a href="#31">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="31">31. è¡Œåˆ—ç©ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä¾‹ Cpp</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include "matrix.h"
</span><span class="kt">void</span> <span class="n">init2d</span><span class="p">();</span>
<span class="kt">void</span> <span class="n">mxm2d</span><span class="p">();</span>
<span class="cm">/* ä¸»ãƒ—ãƒ­ã‚°ãƒ©ãƒ éƒ¨åˆ† */</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">init2d</span><span class="p">();</span>
  <span class="n">mxm2d</span><span class="p">();</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">init2d</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">nsize</span><span class="p">;</span>
  <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span> <span class="o">=</span> <span class="n">MATSIZE</span><span class="p">;</span>
  <span class="n">nsize</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">ipp</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">jpp</span><span class="p">){</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">nsize</span><span class="p">;</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">b2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">c2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="kt">void</span> <span class="nf">mxm2d</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">nsize</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">c1</span><span class="p">;</span>
  <span class="n">nsize</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">ipp</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">jpp</span><span class="p">){</span>
      <span class="n">c1</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">kpp</span><span class="p">){</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span>
        <span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">matrix</span><span class="p">.</span><span class="n">b2d</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
      <span class="p">}</span>
    <span class="n">matrix</span><span class="p">.</span><span class="n">c2d</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c1</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ« matrix.h ã®å†…å®¹</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cp">#define MATSIZE 1000
</span><span class="k">struct</span> <span class="n">matrix</span> <span class="p">{</span>
  <span class="kt">double</span> <span class="n">a2d</span><span class="p">[</span><span class="n">MATSIZE</span><span class="p">][</span><span class="n">MATSIZE</span><span class="p">];</span>
  <span class="kt">double</span> <span class="n">b2d</span><span class="p">[</span><span class="n">MATSIZE</span><span class="p">][</span><span class="n">MATSIZE</span><span class="p">];</span>
  <span class="kt">double</span> <span class="n">c2d</span><span class="p">[</span><span class="n">MATSIZE</span><span class="p">][</span><span class="n">MATSIZE</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">nsize</span><span class="p">;</span>
<span class="p">}</span> <span class="n">matrix</span><span class="p">;</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#30">â†</a><a href="#32">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="32">32. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¸ã®PMlibã®è¿½åŠ </h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">å…ƒã®ä¸»ãƒ—ãƒ­ã‚°ãƒ©ãƒ éƒ¨åˆ†</th>
<th class="tableblock halign-left valign-top">PMlibã‚’è¿½åŠ ã—ãŸä¸»ãƒ—ãƒ­ã‚°ãƒ©ãƒ éƒ¨åˆ†</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cm">/* ãƒ˜ãƒƒãƒ€ãƒ¼ */</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>

<span class="cm">/* åˆæœŸè¨­å®š */</span>

<span class="cm">/* æ¸¬å®šåŒºé–“1 */</span>
<span class="n">init2d</span><span class="p">();</span>


<span class="cm">/* æ¸¬å®šåŒºé–“2 */</span>
<span class="n">mxm2d</span><span class="p">();</span>




<span class="cm">/* ãƒ¬ãƒãƒ¼ãƒˆã‚’å‡ºåŠ› */</span>


<span class="k">return</span> <span class="mi">0</span><span class="p">;</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cm">/* ãƒ˜ãƒƒãƒ€ãƒ¼è¿½åŠ  */</span>
<span class="cp">#include &lt;PerfMonitor.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">pm_lib</span><span class="p">;</span>
<span class="n">PerfMonitor</span> <span class="n">PM</span><span class="p">;</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="n">PM</span><span class="p">.</span><span class="n">initialize</span><span class="p">();</span>
<span class="cm">/* åˆæœŸè¨­å®š */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">setProperties</span><span class="p">(</span><span class="s">"A:init2d"</span><span class="p">,</span> <span class="n">PM</span><span class="p">.</span><span class="n">CALC</span><span class="p">);</span>
<span class="n">PM</span><span class="p">.</span><span class="n">setProperties</span><span class="p">(</span><span class="s">"B:mxm2d"</span><span class="p">,</span> <span class="n">PM</span><span class="p">.</span><span class="n">CALC</span><span class="p">);</span>
<span class="cm">/* æ¸¬å®šåŒºé–“1 */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="s">"A:init2d"</span><span class="p">);</span>
<span class="n">init2d</span><span class="p">();</span>
<span class="n">PM</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="s">"A:init2d"</span><span class="p">);</span>
<span class="cm">/* æ¸¬å®šåŒºé–“2 */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="s">"B:mxm2d"</span><span class="p">);</span>
<span class="n">mxm2d</span><span class="p">();</span>
<span class="n">PM</span><span class="p">.</span><span class="n">stop</span> <span class="p">(</span><span class="s">"B:mxm2d"</span><span class="p">);</span>
<span class="cm">/* ãƒ¬ãƒãƒ¼ãƒˆã‚’å‡ºåŠ› */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span> <span class="s">""</span><span class="p">);</span>
<span class="n">PM</span><span class="p">.</span><span class="n">printDetail</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#31">â†</a><a href="#33">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="33">33. ã‚³ãƒ³ãƒ‘ã‚¤ãƒ« FX100ãƒ»äº¬ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦PMlibã‚’ãƒªãƒ³ã‚¯ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹</p>
<div class="ulist">
<ul>
<li>
<p>x.compile-cpp-K-serial.sh</p>
</li>
<li>
<p>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å†…å®¹ã‚’ç¢ºèªã™ã‚‹</p>
</li>
<li>
<p>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒçµ‚äº†ã™ã‚‹ã¨å®Ÿè¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ  a.out ãŒç”Ÿæˆã•ã‚Œã‚‹</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span><span class="k">${</span><span class="nv">SCRIPTS</span><span class="k">}</span>/x.compile-cpp-K-serial.sh
<span class="gp">$ </span>file ./a.out
./a.out: ELF 64-bit MSB executable, SPARC V9, total store ordering, version 1 <span class="o">(</span>SYSV<span class="o">)</span>, dynamically linked <span class="o">(</span>uses shared libs<span class="o">)</span>, <span class="k">for </span>GNU/Linux 2.6.12, not stripped</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#32">â†</a><a href="#34">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="34">34. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œ FX100ãƒ»äº¬ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>å¯¾è©±çš„ã‚¸ãƒ§ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³ã®é–‹å§‹</p>
<div class="ulist">
<ul>
<li>
<p>äº¬ã‚„FX100ãªã©ã¯ãƒãƒƒãƒã‚¸ãƒ§ãƒ–ç®¡ç†ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€#è¨ˆç®—ãƒãƒ¼ãƒ‰#1å°ã‚’åˆ©
ç”¨ã™ã‚‹å¯¾è©±çš„ã‚¸ãƒ§ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’èµ·å‹•ã™ã‚‹ã€‚</p>
</li>
<li>
<p>FX100ã§ã¯ã‚·ã‚¹ãƒ†ãƒ æ¯ã«pjsub ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãŒç•°ãªã‚‹ã€‚é©å®œå¯¾å¿œã€‚</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span>pjsub --interact --rsc-list <span class="s2">"elapse=01:00:00"</span> --rsc-list <span class="s2">"node=1"</span> --mpi <span class="s2">"proc=8"</span>
<span class="o">[</span>INFO] PJM 0000 pjsub Job 2955440 submitted.
<span class="o">[</span>INFO] PJM 0081 ....connected.
<span class="o">[</span>INFO] PJM 0082 pjsub Interactive job 2955440 started.</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>è¨ˆç®—ãƒãƒ¼ãƒ‰ä¸Šã§å¯¾è©±çš„ã‚¸ãƒ§ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒå§‹ã¾ã£ãŸã‚‰ã€æœ€åˆã«ç’°å¢ƒè¨­å®šã‚’è¡Œã†</p>
<div class="ulist">
<ul>
<li>
<p>FX100ã§ã¯ã‚·ã‚¹ãƒ†ãƒ æ¯ã«ç’°å¢ƒè¨­å®šæ–¹æ³•ãŒç•°ãªã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚é©å®œå¯¾å¿œã€‚</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span><span class="nb">source</span> /work/system/Env_base  <span class="c"># äº¬ã®å ´åˆ</span>
<span class="gp">$ </span>/opt/FJSVXosPA/bin/xospastop  <span class="c"># äº¬ã®å ´åˆ</span>
<span class="gp">$ </span><span class="nv">MY_SRC</span><span class="o">=</span><span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/pmlib/mysrc
<span class="gp">$ </span><span class="nb">cd</span> <span class="k">${</span><span class="nv">MY_SRC</span><span class="k">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#33">â†</a><a href="#35">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="35">35. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œ FX100ãƒ»äº¬ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>è¨ˆç®—ãƒãƒ¼ãƒ‰ä¸Šã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã™ã‚‹ã€‚</p>
<div class="ulist">
<ul>
<li>
<p>ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ãƒ¦ãƒ¼ã‚¶ãƒ¼ç”³å‘Šãƒ¢ãƒ¼ãƒ‰ã§æ¸¬å®šã•ã‚Œã‚‹</p>
</li>
<li>
<p>æ¨™æº–å‡ºåŠ›ã«åŸºæœ¬ãƒ¬ãƒãƒ¼ãƒˆãƒ»è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆãŒå‡ºåŠ›ã•ã‚Œã‚‹äº‹ã‚’ç¢ºèª</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>./a.out</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>ç’°å¢ƒå¤‰æ•°HWPC_CHOOSERã«FLOPSã‚’æŒ‡å®šã—ã¦å†åº¦å®Ÿè¡Œã™ã‚‹</p>
<div class="ulist">
<ul>
<li>
<p>HWPCã«ã‚ˆã‚‹è‡ªå‹•æ¸¬å®šãƒ¢ãƒ¼ãƒ‰(è¨ˆç®—é‡ã®è‡ªå‹•æ¸¬å®š)</p>
</li>
<li>
<p>åŸºæœ¬ãƒ¬ãƒãƒ¼ãƒˆãƒ»è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèª</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span><span class="nb">export </span><span class="nv">HWPC_CHOOSER</span><span class="o">=</span>FLOPS
<span class="gp">$ </span>./a.out</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#34">â†</a><a href="#36">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="36">36. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¸ã®OpenMPæŒ‡ç¤ºè¡Œã®è¿½åŠ </h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«OpenMPæŒ‡ç¤ºè¡Œã‚’è¿½åŠ </p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="kt">void</span> <span class="nf">init2d</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">nsize</span><span class="p">;</span>
  <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span> <span class="o">=</span> <span class="n">MATSIZE</span><span class="p">;</span>
  <span class="n">nsize</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span><span class="p">;</span>
  <span class="cp">#pragma omp parallel for private(i,j)
</span>  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">ipp</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">jpp</span><span class="p">){</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">nsize</span><span class="p">;</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">b2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">c2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="kt">void</span> <span class="nf">mxm2d</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">nsize</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">c1</span><span class="p">;</span>
  <span class="n">nsize</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span><span class="p">;</span>
  <span class="cp">#pragma omp parallel for private(i,j,k,c1)
</span>  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">ipp</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">jpp</span><span class="p">){</span>
      <span class="n">c1</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">kpp</span><span class="p">){</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span>
        <span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">matrix</span><span class="p">.</span><span class="n">b2d</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="p">...</span><span class="err">ä»¥ä¸‹ç•¥</span><span class="p">...</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#35">â†</a><a href="#37">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="37">37. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å†å®Ÿè¡Œ FX100ãƒ»äº¬ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ãƒ­ã‚°ã‚¤ãƒ³ãƒãƒ¼ãƒ‰ä¸Šã§å†åº¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>$ ${SCRIPTS}/x.compile-app-K-serial.sh</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>#è¨ˆç®—ãƒãƒ¼ãƒ‰ä¸Šã§#å¯¾è©±çš„ã‚¸ãƒ§ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³ã‚’ç¶™ç¶šãƒ»å†é–‹</p>
<div class="ulist">
<ul>
<li>
<p>ã‚‚ã—å…ˆã«é–‹å§‹ã—ãŸã‚¸ãƒ§ãƒ–ã‚»ãƒƒã‚·ãƒ§ãƒ³ãŒçµ‚äº†ã—ã¦ã„ã‚Œã°ã‚¸ãƒ§ãƒ–ã®å†æŠ•å…¥ã¨ç’°
å¢ƒè¨­å®šã‚’å†å®Ÿæ–½</p>
</li>
<li>
<p>æ¸¬å®šæ¡ä»¶(ç’°å¢ƒå¤‰æ•°)ã‚’è¿½åŠ ãƒ»å¤‰æ›´ã—ã¦å‡ºåŠ›çµæœã‚’æ¯”è¼ƒã™ã‚‹</p>
<div class="ulist">
<ul>
<li>
<p>OMP_NUM_THREADS=1/2/4/8ãªã©:OpenMPã‚¹ãƒ¬ãƒƒãƒ‰æ•°</p>
</li>
<li>
<p>HWPC_CHOOSER=FLOPS/BANDWIDTH/ãªã©:HWPCæ¸¬å®šã®ã‚¿ã‚¤ãƒ—</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span><span class="nb">export </span><span class="nv">HWPC_CHOOSER</span><span class="o">=</span>FLOPS
<span class="gp">$ </span><span class="nb">export </span><span class="nv">OMP_NUM_THREADS</span><span class="o">=</span>4
<span class="gp">$ </span>./a.out</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#36">â†</a><a href="#38">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="38">38. Apple Mac</h2>
<div class="sectionbody">
<div class="paragraph text-center">
<p>10åˆ†+ã§ã§ãã‚‹PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨åˆ©ç”¨ğŸ˜š</p>
</div>
<div class="paragraph text-center">
<p>Apple Macç·¨</p>
</div>
<div class="paragraph text-center">
<p>(OSX10.11ä»¥é™)</p>
</div>
<div class="paragraph">
<p><a href="#37">â†</a><a href="#39">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="39">39. PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨åˆ©ç”¨å®Ÿè¡Œ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</p>
<div class="ulist">
<ul>
<li>
<p>PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å…¥æ‰‹</p>
</li>
<li>
<p>PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«</p>
</li>
</ul>
</div>
</li>
<li>
<p>PMlibã®åˆ©ç”¨å®Ÿè¡Œ</p>
<div class="ulist">
<ul>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ(Cppè¨€èªã§ä½œæˆ)</p>
</li>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¸ã®PMlibã®è¿½åŠ (ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ç·¨é›†)</p>
</li>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦PMlibã‚’ãƒªãƒ³ã‚¯ã™ã‚‹</p>
</li>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã—ã¦ã€PMlibã®ãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèªã™ã‚‹</p>
</li>
</ul>
</div>
</li>
<li>
<p>(æ³¨)Apple Macç’°å¢ƒã§ã¯Cã‚³ãƒ³ãƒ‘ã‚¤ãƒ©(Clang)ã¯æ¨™æº–ã§å‚™ã‚ã£ã¦ã„ã‚‹ãŒFortranã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã€MPIãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯é€šå¸¸åˆ©ç”¨è€…ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚ã“ã®èª¬æ˜è³‡æ–™ã§ã¯Cã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯æ¨™æº–ã®clangã€Fortranã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã¯GNUFortran(gfortran:GNU Cã«ä»˜å±)ã€MPIã¯OpenMPIãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ã¦æ›¸ã‹ã‚Œã¦ã„ã‚‹ã€‚</p>
</li>
<li>
<p>(æ³¨)Apple Macç’°å¢ƒã§ã¯HWPC/PAPIãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ãªã„ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#38">â†</a><a href="#40">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="40">40. PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å…¥æ‰‹(å…±é€š)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸å…¬é–‹ãƒªãƒã‚¸ãƒˆãƒª</p>
<div class="ulist">
<ul>
<li>
<p><a href="http://avr-aics-riken.github.io/PMlib/" class="bare">http://avr-aics-riken.github.io/PMlib/</a></p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock">
<div class="content">
<img src="download.png" alt="ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹ãŸã‚ã®GitHubãƒšãƒ¼ã‚¸ã‚’ç¤ºã™ç”»åƒ">
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«åã¯ avr-aics-riken-PMlib-*.tar.gz</p>
<div class="ulist">
<ul>
<li>
<p>(\*ã®éƒ¨åˆ†ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ã‚ˆã‚Šå¤‰ã‚ã‚‹)</p>
</li>
</ul>
</div>
</li>
<li>
<p>ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ã«è»¢é€ã™ã‚‹ã€‚æ‰‹æŒã¡ã®PCã¸ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å ´åˆã¯ã€ã‚‚ã¡ã‚ã‚“è»¢é€ä¸è¦ã€‚</p>
<div class="ulist">
<ul>
<li>
<p>ä»¥é™ã®ä¾‹ã§ã¯ ${HOME}/tmp/ ä¸‹ã«è»¢é€ã—ãŸã¨ä»®å®š</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#39">â†</a><a href="#41">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="41">41. PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®å±•é–‹(å…±é€š)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆã®ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ä¸Šã§ã€è»¢é€ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å±•é–‹ã™ã‚‹</p>
</li>
<li>
<p>å±•é–‹ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«ã‚·ãƒ³ãƒœãƒªãƒƒã‚¯ãƒªãƒ³ã‚¯ã¨ã€ãƒ‘ã‚¹ã®ç’°å¢ƒå¤‰æ•°ã‚’è¨­å®šã™ã‚‹ã€‚</p>
</li>
<li>
<p>ä»¥ä¸‹ã®ä¾‹ã§ã¯ãƒ­ã‚°ã‚¤ãƒ³å¾Œãƒ›ãƒ¼ãƒ ã« pmlib ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’ä½œã£ã¦ã€ãã®ä¸‹ã« è»¢é€ã—ãŸãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å±•é–‹ã™ã‚‹ã€‚</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span>mkdir pmlib
<span class="gp">$ </span><span class="nb">cd </span>pmlib
<span class="gp">$ </span>tar â€“zxf <span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/tmp/avr-aics-riken-PMlib-<span class="k">*</span>.tar.gz
<span class="gp">$ </span>ls â€“go
drwxr-xr-x 10 4096 2016-06-21 15:13 avr-aics-riken-PMlib-7d4884d
<span class="gp">$ </span>ln â€“s avr-aics-riken-PMlib-<span class="k">*</span> PMlib
<span class="gp">$ </span>ls â€“go
lrwxrwxrwx 1 12 2016-06-21 15:15 PMlib -&gt; avr-aics-riken-PMlib-7d4884d
<span class="gp">$ </span><span class="nv">PMLIB_DIR</span><span class="o">=</span><span class="k">${</span><span class="nv">PWD</span><span class="k">}</span>/PMlib          <span class="c"># PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’å±•é–‹ã—ãŸãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª</span>
<span class="gp">$ </span><span class="nv">INSTALL_DIR</span><span class="o">=</span><span class="k">${</span><span class="nv">PWD</span><span class="k">}</span>/install_dir  <span class="c"># PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å…ˆãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª</span>
<span class="gp">$ </span><span class="nb">export </span>PMLIB_DIR INSTALL_DIR</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#40">â†</a><a href="#42">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="42">42. PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« Apple Macç’°å¢ƒ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>Apple Macç’°å¢ƒç”¨ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹ã¯ä»¥ä¸‹ã«æä¾›ã•ã‚Œã¦ã„ã‚‹</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>$ SCRIPTS=${PMLIB_DIR}/doc/scripts/Mac/</code></p>
</div>
<div class="ulist">
<ul>
<li>
<p>ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ç¨®é¡ã«ã‚ˆã‚Šã€PMlibã€Œ1ãƒ—ãƒ­ã‚»ã‚¹ç‰ˆã€ã‹ã€ŒMPIç‰ˆã€ã‹ã®ã©ã¡ã‚‰ã‹ã‚’ä½¿ç”¨ã™ã‚‹ã®ã§ã€ä¸¡æ–¹ã¨ã‚‚ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã€‚</p>
</li>
<li>
<p>ã€Œ1ãƒ—ãƒ­ã‚»ã‚¹ç‰ˆã€ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ${SCRIPTS}/x.make-mac-clang-serial.sh</p>
</li>
<li>
<p>ã€ŒMPIç‰ˆã€ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆ ${SCRIPTS}/x.make-mac-clang-openmpi.sh</p>
</li>
<li>
<p>ã€ŒMPIç‰ˆã€ã®ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã¯OpenMPIãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸãƒ‘ã‚¹ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèªã—ã¦ã€å¿…è¦ã§ã‚ã‚Œã°ä¿®æ­£ã™ã‚‹ã€‚</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>export OPENMPI_DIR=/usr/local/openmpi/openmpi-1.10.2-clang</code></p>
</div>
<div class="paragraph">
<p><a href="#41">â†</a><a href="#43">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="43">43. PMlibã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« Apple Macç’°å¢ƒ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’2ã¤é †ã«å®Ÿè¡Œ</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre>$ ${SCRIPTS}/x.make-mac-clang-serial.sh # ã€Œ1ãƒ—ãƒ­ã‚»ã‚¹ç‰ˆã€PMlib
$ ${SCRIPTS}/x.make-mac-clang-openmpi.sh # ã€ŒMPIç‰ˆã€PMlib</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>ä»¥ä¸‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸäº‹ã‚’ç¢ºèªã™ã‚‹</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span>ls â€“go <span class="k">${</span><span class="nv">INSTALL_DIR</span><span class="k">}</span>
drwxr-xr-x 3 102 6 19 17:51 bin
drwxr-xr-x 6 204 6 19 17:51 doc
drwxr-xr-x 7 238 6 19 17:51 include
drwxr-xr-x 4 136 6 19 17:51 lib
drwxr-xr-x 7 238 6 19 17:51 share
<span class="gp">$ </span>ls â€“go <span class="k">${</span><span class="nv">INSTALL_DIR</span><span class="k">}</span>/lib
-rw-r--r-- 1 145784 5 27 17:15 libPM.a     <span class="c"># ã€Œ1ãƒ—ãƒ­ã‚»ã‚¹ç‰ˆã€PMlibãƒ©ã‚¤ãƒ–ãƒ©ãƒª</span>
-rw-r--r-- 1 472104 6 19 17:51 libPMmpi.a  <span class="c"># ã€ŒMPIç‰ˆã€PMlibãƒ©ã‚¤ãƒ–ãƒ©ãƒª</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>ä»¥ä¸Šã§PMlibã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«çµ‚äº†!</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#42">â†</a><a href="#44">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="44">44. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ä½œæˆ(Cppç‰ˆ)</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>é©å½“ãªãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒª ${MY_SRC} ã®ä¸‹ã«ãƒ—ãƒ­ã‚°ãƒ©ãƒ  mxm.cpp ã‚’ä½œæˆã™ã‚‹</p>
</li>
<li>
<p>Næ¬¡ã®æ­£æ–¹è¡Œåˆ—ã®ç©ã‚’è¨ˆç®—ã™ã‚‹ãƒ—ãƒ­ã‚°ãƒ©ãƒ </p>
<div class="ulist">
<ul>
<li>
<p>ä¸»ãƒ—ãƒ­ã‚°ãƒ©ãƒ :é–¢æ•°1ã¨é–¢æ•°2ã‚’å‘¼ã³å‡ºã—ã¦è¡Œåˆ—ç©ã®è¨ˆç®—ã‚’è¡Œã†ã€‚</p>
</li>
<li>
<p>é–¢æ•°1:æ­£æ–¹è¡Œåˆ—[A]ã€[B]ã®å„è¦ç´ ã‚’å€¤1.0ã§åˆæœŸåŒ–ã™ã‚‹</p>
</li>
<li>
<p>é–¢æ•°2:è¡Œåˆ—ç©[C]=[A][B]ã‚’è¨ˆç®—ã™ã‚‹</p>
</li>
<li>
<p>ã‚·ãƒªã‚¢ãƒ«ãƒ—ãƒ­ã‚°ãƒ©ãƒ (MPIä¸è¦ã€OpenMPä¸è¦)</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span><span class="nv">MY_SRC</span><span class="o">=</span><span class="k">${</span><span class="nv">HOME</span><span class="k">}</span>/pmlib/mysrc
<span class="gp">$ </span>mkdir -p <span class="k">${</span><span class="nv">MY_SRC</span><span class="k">}</span>
<span class="gp">$ </span><span class="nb">cd</span> <span class="k">${</span><span class="nv">MY_SRC</span><span class="k">}</span></code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>è‡ªåˆ†ã§ã‚½ãƒ¼ã‚¹ã‚’æ›¸ã„ã¦ã‚‚ã‚‚ã¡ã‚ã‚“è‰¯ã„ vi mxm.cpp</p>
</li>
<li>
<p>æ‰‹æ—©ãé€²ã¿ãŸã„å ´åˆã¯ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä¾‹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ã‚‚è‰¯ã„</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>$ vi mxm.cpp</code>
ã‚ã‚‹ã„ã¯
<code>$ cp â€“p ${PMLIB_DIR}/doc/src_tutorial/mxm.cpp ./</code></p>
</div>
<div class="paragraph">
<p><a href="#43">â†</a><a href="#45">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="45">45. è¡Œåˆ—ç©ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ä¾‹ Cpp</h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cp">#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include "matrix.h"
</span><span class="kt">void</span> <span class="n">init2d</span><span class="p">();</span>
<span class="kt">void</span> <span class="n">mxm2d</span><span class="p">();</span>
<span class="cm">/* ä¸»ãƒ—ãƒ­ã‚°ãƒ©ãƒ éƒ¨åˆ† */</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
  <span class="n">init2d</span><span class="p">();</span>
  <span class="n">mxm2d</span><span class="p">();</span>
  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span> <span class="nf">init2d</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">nsize</span><span class="p">;</span>
  <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span> <span class="o">=</span> <span class="n">MATSIZE</span><span class="p">;</span>
  <span class="n">nsize</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">ipp</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">jpp</span><span class="p">){</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">nsize</span><span class="p">;</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">b2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">c2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="kt">void</span> <span class="nf">mxm2d</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">nsize</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">c1</span><span class="p">;</span>
  <span class="n">nsize</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
      <span class="n">c1</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">k</span><span class="o">++</span><span class="p">){</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span>
        <span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">matrix</span><span class="p">.</span><span class="n">b2d</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">c2d</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">c1</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ« matrix.h ã®å†…å®¹</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cp">#define MATSIZE 1000
</span><span class="k">struct</span> <span class="n">matrix</span> <span class="p">{</span>
  <span class="kt">double</span> <span class="n">a2d</span><span class="p">[</span><span class="n">MATSIZE</span><span class="p">][</span><span class="n">MATSIZE</span><span class="p">];</span>
  <span class="kt">double</span> <span class="n">b2d</span><span class="p">[</span><span class="n">MATSIZE</span><span class="p">][</span><span class="n">MATSIZE</span><span class="p">];</span>
  <span class="kt">double</span> <span class="n">c2d</span><span class="p">[</span><span class="n">MATSIZE</span><span class="p">][</span><span class="n">MATSIZE</span><span class="p">];</span>
  <span class="kt">int</span> <span class="n">nsize</span><span class="p">;</span>
<span class="p">}</span> <span class="n">matrix</span><span class="p">;</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#44">â†</a><a href="#46">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="46">46. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¸ã®PMlibã®è¿½åŠ </h2>
<div class="sectionbody">
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">å…ƒã®ä¸»ãƒ—ãƒ­ã‚°ãƒ©ãƒ éƒ¨åˆ†</th>
<th class="tableblock halign-left valign-top">PMlibã‚’è¿½åŠ ã—ãŸä¸»ãƒ—ãƒ­ã‚°ãƒ©ãƒ éƒ¨åˆ†</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cm">/* ãƒ˜ãƒƒãƒ€ãƒ¼ */</span>


<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="cm">/* åˆæœŸè¨­å®š */</span>


<span class="cm">/* æ¸¬å®šåŒºé–“1 */</span>
<span class="n">init2d</span><span class="p">();</span>


<span class="cm">/* æ¸¬å®šåŒºé–“2 */</span>
<span class="n">mxm2d</span><span class="p">();</span>


<span class="cm">/* ãƒ¬ãƒãƒ¼ãƒˆã‚’å‡ºåŠ› */</span>


<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="cm">/* ãƒ˜ãƒƒãƒ€ãƒ¼è¿½åŠ  */</span>
<span class="cp">#include &lt;PerfMonitor.h&gt;
</span><span class="k">using</span> <span class="k">namespace</span> <span class="n">pm_lib</span><span class="p">;</span>
<span class="n">PerfMonitor</span> <span class="n">PM</span><span class="p">;</span>
<span class="kt">int</span> <span class="n">main</span><span class="p">();</span>
<span class="p">{</span>
<span class="n">PM</span><span class="p">.</span><span class="n">initialize</span><span class="p">;</span>
<span class="cm">/* åˆæœŸè¨­å®š */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">setProperties</span><span class="p">(</span><span class="s">"A:init2d"</span><span class="p">,</span> <span class="n">PM</span><span class="p">.</span><span class="n">CALC</span><span class="p">);</span>
<span class="n">PM</span><span class="p">.</span><span class="n">setProperties</span><span class="p">(</span><span class="s">"B:mxm2d"</span><span class="p">,</span> <span class="n">PM</span><span class="p">.</span><span class="n">CALC</span><span class="p">);</span>
<span class="cm">/* æ¸¬å®šåŒºé–“1 */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="s">"A:init2d"</span><span class="p">);</span>
<span class="n">init2d</span><span class="p">();</span>
<span class="n">PM</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="s">"A:init2d"</span><span class="p">);</span>
<span class="cm">/* æ¸¬å®šåŒºé–“2 */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">start</span><span class="p">(</span><span class="s">"B:mxm2d"</span><span class="p">);</span>
<span class="n">mxm2d</span><span class="p">();</span>
<span class="n">PM</span><span class="p">.</span><span class="n">stop</span><span class="p">(</span><span class="s">"B:mxm2d"</span><span class="p">);</span>
<span class="cm">/* ãƒ¬ãƒãƒ¼ãƒˆã‚’å‡ºåŠ› */</span>
<span class="n">PM</span><span class="p">.</span><span class="n">print</span><span class="p">(</span><span class="n">stdout</span><span class="p">,</span><span class="s">""</span><span class="p">,</span><span class="s">""</span><span class="p">);</span>
<span class="n">PM</span><span class="p">.</span><span class="n">printDetail</span><span class="p">(</span><span class="n">stdout</span><span class="p">);</span>
<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#45">â†</a><a href="#47">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="47">47. ã‚³ãƒ³ãƒ‘ã‚¤ãƒ« clangã‚³ãƒ³ãƒ‘ã‚¤ãƒ©</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦PMlibã‚’ãƒªãƒ³ã‚¯ã™ã‚‹ã‚¹ã‚¯ãƒªãƒ—ãƒˆä¾‹</p>
<div class="ulist">
<ul>
<li>
<p>x.compile-cpp-mac-serial.sh</p>
</li>
<li>
<p>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’é–‹å§‹ã™ã‚‹å‰ã«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å†…å®¹ã‚’ç¢ºèªã™ã‚‹</p>
</li>
<li>
<p>ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãŒçµ‚äº†ã™ã‚‹ã¨å®Ÿè¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ  a.out ãŒç”Ÿæˆã•ã‚Œã‚‹</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span><span class="k">${</span><span class="nv">SCRIPTS</span><span class="k">}</span>/x.compile-cpp-mac-serial.sh

<span class="gp">$ </span>file ./a.out
./a.out: Mach-O 64-bit executable x86_64</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#46">â†</a><a href="#48">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="48">48. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å®Ÿè¡Œ clangã‚³ãƒ³ãƒ‘ã‚¤ãƒ©</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ä¾‹:ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã«ã‚ˆã‚‹å®Ÿè¡Œä¾‹ã€‚</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span>cp <span class="k">${</span><span class="nv">SCRIPTS</span><span class="k">}</span>/x.run-mac-serial.sh ./
<span class="gp">$ </span>vi x.run-mac-serial.sh
<span class="gp">$ </span>./x.run-mac-serial.sh</code></pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>å®Ÿè¡Œçµæœã®æ¨™æº–å‡ºåŠ›ã§PMlibã®åŸºæœ¬ãƒ¬ãƒãƒ¼ãƒˆãƒ»è©³ç´°ãƒ¬ãƒãƒ¼ãƒˆã‚’ç¢ºèª</p>
</li>
</ul>
</div>
<div class="paragraph">
<p><a href="#47">â†</a><a href="#49">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="49">49. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¸ã®OpenMPæŒ‡ç¤ºè¡Œã®è¿½åŠ </h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>ã‚½ãƒ¼ã‚¹ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã«OpenMPæŒ‡ç¤ºè¡Œã‚’è¿½åŠ </p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"></th>
<th class="tableblock halign-left valign-top"></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="kt">void</span> <span class="nf">init2d</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">nsize</span><span class="p">;</span>
  <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span> <span class="o">=</span> <span class="n">MATSIZE</span><span class="p">;</span>
  <span class="n">nsize</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span><span class="p">;</span>
  <span class="cp">#pragma omp parallel for private(i,j)
</span>  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">ipp</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">jpp</span><span class="p">){</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="kt">double</span><span class="p">)(</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="kt">double</span><span class="p">)</span><span class="n">nsize</span><span class="p">;</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">b2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span><span class="o">-</span><span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">];</span>
      <span class="n">matrix</span><span class="p">.</span><span class="n">c2d</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span></code></pre>
</div>
</div></div></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="cpp"><span class="kt">void</span> <span class="nf">mxm2d</span><span class="p">()</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">nsize</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">c1</span><span class="p">;</span>
  <span class="n">nsize</span> <span class="o">=</span> <span class="n">matrix</span><span class="p">.</span><span class="n">nsize</span><span class="p">;</span>
  <span class="cp">#pragma omp parallel for private(i,j,k,c1)
</span>  <span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">ipp</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">jpp</span><span class="p">){</span>
      <span class="n">c1</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
      <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">k</span><span class="o">&lt;</span><span class="n">nsize</span><span class="p">;</span> <span class="n">kpp</span><span class="p">){</span>
        <span class="n">c1</span> <span class="o">=</span> <span class="n">c1</span> <span class="o">+</span>
        <span class="n">matrix</span><span class="p">.</span><span class="n">a2d</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">matrix</span><span class="p">.</span><span class="n">b2d</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="n">k</span><span class="p">];</span>
      <span class="p">}</span>
      <span class="p">...</span><span class="err">ä»¥ä¸‹ç•¥</span><span class="p">...</span></code></pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#48">â†</a><a href="#50">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="50">50. ä¾‹é¡Œãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã¨å®Ÿè¡Œ Apple Macç’°å¢ƒ</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>å†ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«
<code>$ ${SCRIPTS}/x.compile-cpp-mac-serial.sh</code></p>
</li>
<li>
<p>ç’°å¢ƒå¤‰æ•°ã‚’è¿½åŠ ãƒ»å¤‰æ›´ã—ã¦å†å®Ÿè¡Œ</p>
<div class="ulist">
<ul>
<li>
<p>ã‚¸ãƒ§ãƒ–ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§æ¸¬å®šæ¡ä»¶ã‚’å¤‰æ›´ã—ã¦å‡ºåŠ›çµæœã‚’æ¯”è¼ƒã™ã‚‹</p>
</li>
<li>
<p>OMP_NUM_THREADS=1/2/4/8ãªã©:OpenMPã‚¹ãƒ¬ãƒƒãƒ‰æ•°</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="rouge highlight"><code data-lang="bash"><span class="gp">$ </span>vi x.run-mac-serial.sh
<span class="gp">$ </span>./x.run-mac-serial.sh</code></pre>
</div>
</div>
<div class="paragraph">
<p><a href="#49">â†</a><a href="#51">â†’</a></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="51">51. ä»¥ä¸Šã§ã™ã€‚</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>PMlibã®åŸºæœ¬çš„ãªæ©Ÿèƒ½ã¨åˆ©ç”¨æ–¹æ³•ã«ã¤ã„ã¦ã”ç´¹ä»‹ã—ã¾ã—ãŸã€‚</p>
</li>
<li>
<p>ã•ã‚‰ã«è©³ç´°ãªæ©Ÿèƒ½ã‚„ãã®åˆ©ç”¨æ–¹æ³•ã«ã¤ã„ã¦çŸ¥ã‚ŠãŸã„æ–¹ã¯ã€PMlibãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ä»¥ä¸‹ã®è³‡æ–™ã‚’ã”è¦§ãã ã•ã„ã€‚</p>
</li>
</ul>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 100%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">doc/PMlib.pdf</p>
<p class="tableblock">doc/tutorial/Tutorial-slide1-overview.pdf</p>
<p class="tableblock">doc/tutorial/Tutorial-slide2-installation.pdf</p>
<p class="tableblock">doc/tutorial/PMlib-Getting-Started.pdf</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PMlibåˆ©ç”¨èª¬æ˜æ›¸</p>
<p class="tableblock">è¬›ç¿’ä¼šç”¨è³‡æ–™1</p>
<p class="tableblock">è¬›ç¿’ä¼šç”¨è³‡æ–™2</p>
<p class="tableblock">ç°¡æ˜“ç‰ˆåˆ©ç”¨ã‚¬ã‚¤ãƒ‰(æœ¬è³‡æ–™)</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a href="#50">â†</a><a href="#1">â†‘</a></p>
</div>
</div>
</div>
</div>
</body>
</html>